<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Pacific Islands Digital Dashboard</title>
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <link rel="stylesheet" href="https://unpkg.com/leaflet/dist/leaflet.css" />
  <script src="https://unpkg.com/leaflet/dist/leaflet.js"></script>
  <style>
    body {
      font-family: Arial, sans-serif;
      background-color: #f3f8fb;
      padding: 20px;
    }
    h1 {
      text-align: center;
      color: #2e5984;
    }
    .chart-container, .map-container {
      width: 90%;
      max-width: 900px;
      margin: 40px auto;
      background: #fff;
      padding: 25px;
      border-radius: 10px;
      box-shadow: 0 4px 8px rgba(0,0,0,0.1);
    }
    #map {
      height: 600px;
      width: 100%;
    }
  </style>
</head>
<body>
  <h1>üå¥ Pacific Islands Digital Development Dashboard</h1>

  <!-- 4G Coverage Map -->
  <div class="map-container">
    <h2>üì∂ 4G Mobile Network Coverage</h2>
    <div id="map"></div>
  </div>

  <!-- Broadband Subscriptions Chart -->
  <div class="chart-container">
    <h2>üíª Fixed Broadband Subscriptions per 100 People</h2>
    <canvas id="broadbandChart"></canvas>
  </div>

  <!-- Internet Usage Chart -->
  <div class="chart-container">
    <h2>üåê Internet Usage (% of Individuals)</h2>
    <canvas id="internetChart"></canvas>
  </div>

  <script>
    // Map setup
    const map = L.map('map').setView([-13.5, 167], 4);

    L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
      attribution: '¬© OpenStreetMap contributors'
    }).addTo(map);

    const countries = [
      { name: "Fiji", lat: -17.7134, lon: 178.0650, coverage: 80 },
      { name: "New Caledonia", lat: -20.9043, lon: 165.6180, coverage: 79.5 },
      { name: "PNG", lat: -6.314993, lon: 143.9555, coverage: 50 },
      { name: "Solomon Islands", lat: -9.6457, lon: 160.1562, coverage: 25 },
      { name: "Vanuatu", lat: -15.3767, lon: 166.9592, coverage: 70 },
      { name: "Kiribati", lat: 1.8709, lon: -157.3630, coverage: 64 },
      { name: "Marshall Islands", lat: 7.1315, lon: 171.1845, coverage: 65 },
      { name: "FSM", lat: 6.8876, lon: 158.2150, coverage: 0 },
      { name: "Nauru", lat: -0.5228, lon: 166.9315, coverage: 30 },
      { name: "Cook Islands", lat: -21.2367, lon: -159.7777, coverage: 55 },
      { name: "French Polynesia", lat: -17.6797, lon: -149.4068, coverage: 90 },
      { name: "Niue", lat: -19.0544, lon: -169.8672, coverage: 100 },
      { name: "Samoa", lat: -13.7590, lon: -172.1046, coverage: 99 },
      { name: "Tonga", lat: -21.1789, lon: -175.1982, coverage: 96 },
      { name: "Tuvalu", lat: -7.1095, lon: 177.6493, coverage: 25 }
    ];

    countries.forEach(c => {
      const color = c.coverage >= 90 ? "green" :
                    c.coverage >= 60 ? "orange" :
                    c.coverage > 0 ? "red" : "gray";

      L.circleMarker([c.lat, c.lon], {
        radius: 10,
        color: color,
        fillColor: color,
        fillOpacity: 0.6
      }).addTo(map)
        .bindPopup(`<strong>${c.name}</strong><br>4G Coverage: ${c.coverage}%`);
    });

    // Charts
    const names = countries.map(c => c.name);
    const broadbandData = [2.53, 19.37, 0.21, 0.11, 1.23, 0.04, 2.35, 5.82, 9.96, 21.05, 35.55, null, 0.88, 8.17, 4.52];
    const internetData = [68.9, 82, 11.2, 11.9, 25.7, 14.6, 38.7, 35.3, 57, 54, 88.5, 71.1, 33.6, 41.2, 49.3];

    const colors = names.map((_, i) => `hsl(${i * 25}, 65%, 60%)`);

    const createChart = (id, label, data) => {
      new Chart(document.getElementById(id), {
        type: 'bar',
        data: {
          labels: names.slice(0, data.length),
          datasets: [{
            label,
            data,
            backgroundColor: colors,
          }]
        },
        options: {
          responsive: true,
          plugins: {
            legend: { display: false }
          },
          scales: {
            y: {
              beginAtZero: true
            }
          }
        }
      });
    };

    createChart("broadbandChart", "Broadband Subscriptions", broadbandData);
    createChart("internetChart", "Internet Usage (%)", internetData);
  </script>
</body>
</html>
